<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bilalbera'nÄ±n Oyunu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1f2937;
        }
        /* TÄ±klama Butonuna Ã–zel Stil */
        #clickButton {
            transition: all 0.1s ease;
            box-shadow: 0 6px #0d47a1; 
            position: relative; 
        }
        #clickButton:active {
            box-shadow: 0 0 #0d47a1;
            transform: translateY(6px);
        }
        /* KaydÄ±rma Ã§ubuÄŸu stili */
        #marketItems, #rebirthStoreItems, #leaderboard, #missionList {
            max-height: 500px;
            overflow-y: auto;
        }
        .view-container {
            min-height: 550px; 
        }
        .nav-btn.active {
            background-color: #f59e0b; 
            color: #1f2937;
        }
        #navRebirthStore.active {
            background-color: #a78bfa; 
            color: #1f2937;
        }
        #navCompetition.active {
            background-color: #ef4444; 
            color: #1f2937;
        }
        #navMissions.active { 
            background-color: #34d399; 
            color: #1f2937;
        }
        /* Ayarlar butonu stili */
        #navSettings.active { 
            background-color: #6b7280; 
            color: #ffffff;
        }
        /* Pasif buton stili (YarÄ±ÅŸma sÄ±rasÄ±nda) */
        .nav-btn:disabled, .nav-btn[disabled] {
            opacity: 0.5;
            cursor: not-allowed;
            filter: grayscale(100%);
        }
        /* TÄ±klama Pop-up Animasyonu */
        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }
        .click-popup {
            position: absolute;
            font-size: 1.5rem;
            font-weight: bold;
            color: #34d399; 
            pointer-events: none;
            user-select: none;
            animation: floatUp 1s ease-out forwards;
            white-space: nowrap;
        }
        
        #competitionButton {
            transition: background-color 0.2s;
        }
        #competitionButton:disabled {
            background-color: #4b5563; 
            cursor: not-allowed;
        }
    </style>
</head>
<body class="text-white min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-4xl bg-gray-800 rounded-xl shadow-2xl p-6">
        <h1 class="text-4xl font-extrabold text-center mb-6 text-blue-400">THE CLICKER: Lokal ID</h1>

        <div class="grid grid-cols-2 gap-4 p-4 mb-4 bg-gray-900 rounded-lg border border-gray-700">
            <div class="col-span-1">
                <p class="text-base">ğŸ’° Para:</p>
                <span id="coinDisplay" class="font-bold text-yellow-400 text-3xl block">0</span>
            </div>
            <div class="col-span-1">
                <p class="text-base">ğŸŒŸ Rebirth:</p>
                <span id="rebirthDisplay" class="font-bold text-indigo-400 text-3xl block">0</span>
            </div>
            <div class="col-span-1">
                <p class="text-base text-purple-300">âš›ï¸ RBP (Puan):</p>
                <span id="rbpDisplay" class="font-semibold text-purple-400 text-2xl block">0</span>
            </div>
             <div class="col-span-1">
                <p class="text-base text-red-300">âš™ï¸ Pasif (SBK):</p>
                <span id="passiveRateDisplay" class="font-semibold text-red-400 text-2xl block">0</span>
            </div>
             <div class="col-span-2">
                <p class="text-base text-green-300">âœ¨ TÄ±klama (TBK):</p>
                <span id="clickValueDisplay" class="font-semibold text-green-400 text-2xl block">1</span>
            </div>
            <div class="col-span-2 text-center">
                <p class="text-sm text-gray-400">âš¡ Otomatik TÄ±klama HÄ±zÄ±:</p>
                <span id="autoclickerDisplay" class="font-semibold text-blue-300 text-xl block">0 / sn</span>
            </div>
        </div>

        <nav class="flex justify-center flex-wrap gap-4 mb-6">
            <button id="navClicker" class="nav-btn active px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 font-bold transition duration-150">TÄ±klama Merkezi</button>
            <button id="navMarket" class="nav-btn px-4 py-2 rounded-lg bg-yellow-600 hover:bg-yellow-700 font-bold transition duration-150">Pazar (Para)</button>
            <button id="navMissions" class="nav-btn px-4 py-2 rounded-lg bg-green-600 hover:bg-green-700 font-bold transition duration-150">ğŸ“ GÃ¶revler</button>
            <button id="navRebirthStore" class="nav-btn px-4 py-2 rounded-lg bg-purple-600 hover:bg-purple-700 font-bold transition duration-150">RBP MaÄŸazasÄ±</button>
            <button id="navCompetition" class="nav-btn px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 font-bold transition duration-150">ğŸ’¥ Online YarÄ±ÅŸma</button>
            <button id="navSettings" class="nav-btn px-4 py-2 rounded-lg bg-gray-600 hover:bg-gray-700 font-bold transition duration-150">âš™ï¸ Ayarlar</button>
        </nav>

        <div id="clickerView" class="view-container">
            <div class="p-6 bg-gray-700 rounded-xl shadow-inner border border-blue-500">
                <h2 class="text-3xl font-bold mb-6 text-blue-300 text-center">TÄ±kla ve Kazan!</h2>
                
                <div id="clickerArea" class="relative w-full h-40">
                    <button id="clickButton" 
                            class="w-full h-full bg-blue-600 hover:bg-blue-700 text-white font-extrabold text-5xl rounded-lg border-b-6 border-blue-800 active:border-b-4 transition-all duration-75">
                        TIKLA!
                    </button>
                </div>


                <div class="mt-8 p-4 bg-purple-900 rounded-lg border-2 border-purple-500 text-center">
                    <h3 class="text-2xl font-bold text-purple-300 mb-2">Yeniden DoÄŸuÅŸ (Rebirth)</h3>
                    <p class="text-sm text-gray-300 mb-3">TÃ¼m ilerlemenizi sÄ±fÄ±rlayÄ±n, ancak kalÄ±cÄ± bir Ã§arpan ve RBP kazanÄ±n. (Gereksinim: 100 Net SBK)</p>
                    <button id="rebirthButton" 
                            class="px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-lg rounded-full shadow-lg transition duration-150">
                        YENÄ°DEN DOÄ
                    </button>
                </div>
            </div>
        </div>

        <div id="marketView" class="view-container hidden">
            <div class="p-6 bg-gray-700 rounded-xl shadow-inner border border-yellow-500">
                <h2 class="text-3xl font-bold mb-6 text-yellow-300 text-center">Pazar (Para YÃ¼kseltmeleri)</h2>
                <p class="text-sm text-gray-300 mb-4 text-center">ParalarÄ±nÄ±zÄ± harcayarak TÄ±klama veya Pasif gelirinizi kalÄ±cÄ± olarak artÄ±rÄ±n.</p>
                
                <div id="marketItems" class="space-y-4">
                    </div>
            </div>
        </div>
        
        <div id="missionsView" class="view-container hidden">
            <div class="p-6 bg-gray-700 rounded-xl shadow-inner border border-green-500">
                <h2 class="text-3xl font-bold mb-6 text-green-300 text-center">GÃ–REVLER</h2>
                <p class="text-sm text-gray-300 mb-4 text-center">Ä°lk 4 gÃ¶rev kalÄ±cÄ±dÄ±r. Sonrakiler tamamlandÄ±kÃ§a yerini yeni bir gÃ¶rev alÄ±r.</p>
                
                <div id="missionList" class="space-y-4">
                    </div>
            </div>
        </div>

        <div id="rebirthStoreView" class="view-container hidden">
            <div class="p-6 bg-gray-700 rounded-xl shadow-inner border border-purple-500">
                <h2 class="text-3xl font-bold mb-6 text-purple-300 text-center">Yeniden DoÄŸuÅŸ MaÄŸazasÄ± (RBP)</h2>
                <p class="text-sm text-gray-300 mb-4 text-center">RBP puanlarÄ±nÄ±zÄ± harcayarak oyun boyunca kalÄ±cÄ± olarak etkili olacak yÃ¼kseltmeler alÄ±n.</p>
                
                <div id="rebirthStoreItems" class="space-y-4">
                    </div>
            </div>
        </div>
        
        <div id="competitionView" class="view-container hidden">
            <div class="p-6 bg-gray-700 rounded-xl shadow-inner border border-red-500">
                <h2 class="text-3xl font-bold mb-6 text-red-300 text-center">ğŸ’¥ ONLINE YARIÅMA</h2>
                
                <div class="p-4 mb-4 bg-red-900 rounded-lg text-center font-extrabold text-2xl border-2 border-red-500">
                    Sistem Ã‡evrimdÄ±ÅŸÄ±: Firebase YapÄ±landÄ±rmasÄ± Eksik.
                </div>
                
                <p class="text-center text-lg text-red-300 mt-4">Rekabet modu aktif deÄŸilken ID'niz sadece bir tanÄ±mlayÄ±cÄ±dÄ±r.</p>

                <div id="competitionClickerArea" class="relative w-full h-40 mt-4">
                    <button id="competitionButton" disabled
                            class="w-full h-full bg-red-800 text-white font-extrabold text-3xl rounded-lg opacity-50 cursor-not-allowed">
                        Ã‡evrimdÄ±ÅŸÄ±: YarÄ±ÅŸma Yok
                    </button>
                </div>
                
                <h3 class="text-xl font-bold text-red-300 mt-6 mb-3 text-center">Liderlik Tablosu</h3>
                <div id="leaderboard" class="space-y-2 bg-gray-800 p-4 rounded-lg">
                    <p class="text-center text-gray-400">Online Liderlik Tablosu Ã‡evrimdÄ±ÅŸÄ± Modda KullanÄ±lamaz.</p>
                </div>
                
            </div>
        </div>

        <div id="settingsView" class="view-container hidden">
            <div class="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-500">
                <h2 class="text-3xl font-bold mb-6 text-gray-300 text-center">OYUN AYARLARI</h2>
                
                <div class="p-4 bg-blue-900 rounded-lg border-2 border-blue-500 text-center mb-4">
                    <h3 class="text-xl font-bold text-blue-300 mb-2">ğŸ’¾ Otomatik KayÄ±t</h3>
                    <p class="text-sm text-gray-300">Oyununuz her 5 saniyede bir otomatik olarak kaydedilmektedir.</p>
                </div>

                <div class="mt-8 p-4 bg-red-900 rounded-lg border-2 border-red-500 text-center">
                    <h3 class="text-2xl font-bold text-red-300 mb-2">âš  TÃ¼m Ä°lerlemeyi SÄ±fÄ±rla</h3>
                    <p class="text-sm text-gray-300 mb-4">Bu iÅŸlem geri alÄ±namaz! TÃ¼m paranÄ±z, rebirth'leriniz, RBP puanlarÄ±nÄ±z ve yÃ¼kseltmeleriniz kaybolacaktÄ±r.</p>
                    <button id="resetGameButton" 
                            class="px-8 py-3 bg-red-600 hover:bg-red-700 text-white font-bold text-lg rounded-full shadow-lg transition duration-150">
                        OYUNU SIFIRLA
                    </button>
                </div>
            </div>
        </div>


        <div id="messageBox" class="fixed top-0 left-1/2 transform -translate-x-1/2 mt-4 p-3 bg-red-600 text-white font-bold rounded-lg shadow-xl hidden transition duration-300 ease-in-out">
            Yeterli paranÄ±z yok!
        </div>

        <div class="mt-6 p-2 text-xs text-gray-500 text-center bg-gray-900 rounded-lg">
            KullanÄ±cÄ± KimliÄŸiniz (Lokal ID): <span id="currentUserId" class="font-mono text-gray-300 break-all">ID OluÅŸturuluyor...</span>
        </div>

    </div>

    <script type="module">
        // Firebase import'larÄ± sadece gerekli mantÄ±k iÃ§in tutulur, ancak Ã§alÄ±ÅŸmayacaktÄ±r.
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        
        let FIREBASE_CONFIG = {};
        let IS_FIREBASE_ENABLED = false;
        
        // Placeholder deÄŸerler
        const initialConfigString = typeof __firebase_config !== 'undefined' ? __firebase_config : '{"apiKey": "YOUR_API_KEY", "projectId": "YOUR_PROJECT_ID"}';
        const INITIAL_AUTH_TOKEN = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        try {
            FIREBASE_CONFIG = JSON.parse(initialConfigString);
            // GerÃ§ek bir proje anahtarÄ± varsa Firebase'i aktif etmeye Ã§alÄ±ÅŸÄ±r
            if (FIREBASE_CONFIG && FIREBASE_CONFIG.projectId && FIREBASE_CONFIG.projectId !== "YOUR_PROJECT_ID") {
                IS_FIREBASE_ENABLED = true;
            }
        } catch (e) {
            console.error("Firebase yapÄ±landÄ±rmasÄ± JSON ayrÄ±ÅŸtÄ±rma hatasÄ±:", e);
        }

        let db;
        let auth;
        let userId = null; // Bu, Lokal ID'miz olacak
        
        // ... (DiÄŸer tÃ¼m deÄŸiÅŸken tanÄ±mlarÄ± aynÄ± kalacak) ...
        let coins = 0;             
        let baseClickValue = 1;    
        let basePassiveRate = 0;   
        let rebirths = 0;          
        let rebirthMultiplier = 1; 
        let passiveMultiplier = 1; 
        let rebirthPoints = 0;     
        let rbpStartingCoinBonus = 0; 
        let rbpStartingPassiveBonus = 0; 
        let rbpPermanentClickMultiplierBonus = 0; 
        let rbpPassiveSpeedBonus = 1; 
        let rbpAutoclickerLevel = 0;  
        let lastSaveTime = Date.now();
        const MAX_OFFLINE_TIME_SECONDS = 8 * 60 * 60;
        
        let totalClicks = 0; 
        let totalMarketUpgradesBought = 0;
        let missionStates = {}; 
        let rotatingMissionIndex = 0; 
        
        // YarÄ±ÅŸma durumu (Devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±)
        let competitionActive = false;
        let matchmakingStatus = 'idle'; 
        
        // ... (TÃ¼m HTML Elementleri TanÄ±mlarÄ± AynÄ± Kalacak) ...
        const currentUserIdDisplay = document.getElementById('currentUserId');
        const competitionButton = document.getElementById('competitionButton');
        // ... (Geri kalan elementler) ...
        
        
        // Pazar, RBP ve GÃ¶rev Verileri (AynÄ± Kalacak)
        const MARKET_ITEMS = [/* ... */];
        const REBIRTH_ITEMS = [/* ... */];
        let MISSIONS = [/* ... */];
        const ROTATING_MISSIONS = [/* ... */];

        // ------------------------------------------------------------------
        // YARDIMCI VE UI FONKSÄ°YONLARI
        // ------------------------------------------------------------------

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(2) + " M";
            }
            return Math.floor(num).toLocaleString('tr-TR');
        }
        
        function showMessage(message, type = 'error') {
            // ... (Mesaj gÃ¶sterme mantÄ±ÄŸÄ± aynÄ± kalacak) ...
            messageBox.textContent = message;
            messageBox.className = messageBox.className.replace(/\sbg-(red|green|purple|blue|gray)-\d+/g, '');
            
            if (type === 'error') messageBox.classList.add('bg-red-600');
            else if (type === 'success') messageBox.classList.add('bg-green-600');
            else if (type === 'info') messageBox.classList.add('bg-purple-600');
            else if (type === 'offline') messageBox.classList.add('bg-blue-600');
            else if (type === 'leave') messageBox.classList.add('bg-red-600'); 
            
            messageBox.classList.remove('hidden');
            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 3000); 
        }

        // ... (DiÄŸer UI ve Navigasyon fonksiyonlarÄ± aynÄ± kalacak) ...

        function switchView(viewId) {
             // YarÄ±ÅŸma kontrolÃ¼ (Devre dÄ±ÅŸÄ±)
            if (competitionActive && viewId !== 'competitionView') {
                showMessage("YarÄ±ÅŸma aktifken diÄŸer sayfalara geÃ§emezsiniz.", 'error');
                return; 
            }

            document.querySelectorAll('.view-container').forEach(view => {
                view.classList.add('hidden');
            });
            document.getElementById(viewId)?.classList.remove('hidden');

            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            const navBase = viewId.replace('View', '');
            const navId = 'nav' + navBase.charAt(0).toUpperCase() + navBase.slice(1);
            document.getElementById(navId)?.classList.add('active');
            
            if (viewId === 'marketView') renderMarket(MARKET_ITEMS, marketItemsContainer, buyItem, coins, 'ğŸ’°');
            if (viewId === 'rebirthStoreView') renderMarket(REBIRTH_ITEMS, rebirthStoreItemsContainer, buyRebirthItem, rebirthPoints, 'âš›ï¸');
            if (viewId === 'missionsView') renderMissions();
            
            if (viewId === 'competitionView' && !IS_FIREBASE_ENABLED) {
                showMessage("Online Rekabet Modu devre dÄ±ÅŸÄ±dÄ±r. Kendi ID'nizle oynamaya devam edebilirsiniz.", 'error');
            }
        }
        
        // ------------------------------------------------------------------
        // FIREBASE Ä°ÅLEMLERÄ° (Lokal ID Ãœretimiyle DeÄŸiÅŸtirildi)
        // ------------------------------------------------------------------

        // Lokal ID OluÅŸturma (Ã‡evrimdÄ±ÅŸÄ± ID iÃ§in)
        function generateLocalUserId() {
            // Basit bir 10 haneli alfanÃ¼merik ID oluÅŸturur
            return 'LCL-' + Math.random().toString(36).substring(2, 12).toUpperCase();
        }

        async function initializeFirebase() {
            let loadedUserId = localStorage.getItem('localUserId');
            
            if (loadedUserId) {
                userId = loadedUserId;
            } else {
                userId = generateLocalUserId();
                localStorage.setItem('localUserId', userId);
            }
            
            // ID'yi hemen gÃ¶ster
            currentUserIdDisplay.textContent = userId;
            
            if (!IS_FIREBASE_ENABLED) {
                console.warn("Firebase anahtarlarÄ± eksik. Lokal ID kullanÄ±lÄ±yor.");
                competitionButton.disabled = true; // Rekabeti devre dÄ±ÅŸÄ± bÄ±rak
                return;
            }

            // EÄŸer anahtarlar varsa, Firebase ile baÄŸlanmayÄ± dene
            try {
                const app = initializeApp(FIREBASE_CONFIG);
                auth = getAuth(app);
                db = getFirestore(app);

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid; // Firebase ID'si Lokal ID'nin yerine geÃ§er
                        currentUserIdDisplay.textContent = userId; 
                        
                        // Online fonksiyonlarÄ± burada baÅŸlatÄ±lÄ±r (Åu anki kodda boÅŸ bÄ±rakÄ±lmÄ±ÅŸtÄ±r)
                        // startLeaderboardListener(); 
                    } else {
                        // EÄŸer Firebase baÄŸlanamazsa Lokal ID kullanÄ±lmaya devam eder
                    }
                });

                await signInAnonymously(auth);

            } catch (e) {
                console.error("Firebase baÅŸlatma hatasÄ±:", e);
                // Hata durumunda Lokal ID'yi korur
            }
        }
        
        // ... (YarÄ±ÅŸma ve Firebase ile ilgili diÄŸer tÃ¼m fonksiyonlar (loadCompetitionScore, joinQueue vb.) kaldÄ±rÄ±ldÄ± veya devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±) ...

        // ------------------------------------------------------------------
        // OYUN MANTIK VE DÃ–NGÃœSÃœ
        // ------------------------------------------------------------------
        
        // ... (handleManualClick, handlePassiveIncome, updateDisplay, buyItem, buyRebirthItem, performRebirth, renderMarket fonksiyonlarÄ± aynÄ± kalacak) ...
        
        
        // ------------------------------------------------------------------
        // GÃ–REVLER (MISSIONS) MANTIK - DÃœZELTÄ°LDÄ°
        // ------------------------------------------------------------------
        
        // ... (getMissionProgressValue, checkMissionProgress, renderMissions, claimMissionReward, replaceMission fonksiyonlarÄ± aynÄ± ve dÃ¼zgÃ¼n Ã§alÄ±ÅŸÄ±r durumda kalacak) ...
        
        // ------------------------------------------------------------------
        // SIFIRLAMA MANTIK
        // ------------------------------------------------------------------
        
        function resetGame() {
            if (confirm("Emin misiniz? TÃ¼m ilerlemeniz kaybolacak!")) {
                localStorage.removeItem('clickerGameSave');
                localStorage.removeItem('localUserId'); // Lokal ID'yi de sÄ±fÄ±rla

                window.location.reload(); 
            }
        }
        
        // ------------------------------------------------------------------
        // KALICI KAYIT (LOCAL STORAGE)
        // ------------------------------------------------------------------
        
        function saveGame() {
            const gameState = {
                coins, baseClickValue, basePassiveRate, rebirths, rebirthPoints, 
                rebirthMultiplier, passiveMultiplier, rbpStartingCoinBonus, rbpStartingPassiveBonus, 
                rbpPermanentClickMultiplierBonus, rbpAutoclickerLevel, totalClicks, 
                totalMarketUpgradesBought, missionStates, rotatingMissionIndex,
                lastSaveTime: Date.now(), 
                localUserId: userId, // Lokal ID'yi kaydet
                marketItems: MARKET_ITEMS.map(item => ({ id: item.id, level: item.level, cost: item.cost })),
                rebirthItems: REBIRTH_ITEMS.map(item => ({ id: item.id, level: item.level, cost: item.cost })),
            };
            
            localStorage.setItem('clickerGameSave', JSON.stringify(gameState));
            // Ä°steÄŸe baÄŸlÄ±: showMessage("Oyun kaydedildi!", 'info');
        }

        function loadGame() {
            const savedState = localStorage.getItem('clickerGameSave');
            if (savedState) {
                const gameState = JSON.parse(savedState);
                
                coins = gameState.coins || 0;
                // ... (DiÄŸer tÃ¼m deÄŸiÅŸkenlerin yÃ¼klenmesi aynÄ± kalacak) ...
                rebirthMultiplier = gameState.rebirthMultiplier || 1;
                rbpAutoclickerLevel = gameState.rbpAutoclickerLevel || 0;
                totalClicks = gameState.totalClicks || 0;
                totalMarketUpgradesBought = gameState.totalMarketUpgradesBought || 0;
                missionStates = gameState.missionStates || {};
                rotatingMissionIndex = gameState.rotatingMissionIndex || 0;
                
                // Lokal ID'yi kayÄ±ttan yÃ¼kle (InitializeFirebase'de de kontrol edilir)
                userId = gameState.localUserId || generateLocalUserId();
                localStorage.setItem('localUserId', userId); 

                // YÃ¼kseltme seviyelerinin yÃ¼klenmesi
                gameState.marketItems?.forEach(savedItem => {
                    const item = MARKET_ITEMS.find(i => i.id === savedItem.id);
                    if (item) { item.level = savedItem.level; item.cost = savedItem.cost; }
                });
                gameState.rebirthItems?.forEach(savedItem => {
                    const item = REBIRTH_ITEMS.find(i => i.id === savedItem.id);
                    if (item) { item.level = savedItem.level; item.cost = savedItem.cost; }
                });

                // ... (Offline ilerleme hesaplamasÄ± aynÄ± kalacak) ...
                
                showMessage(`Oyun yÃ¼klendi!`, 'success');
            } else {
                showMessage("Yeni Oyun BaÅŸlatÄ±ldÄ±!", 'info');
            }
        }
        
        // ------------------------------------------------------------------
        // OYUN BAÅLATMA
        // ------------------------------------------------------------------

        function startPassiveIncomeLoop() {
            setInterval(handlePassiveIncome, 1000); // Her saniye pasif gelir
        }
        function startAutoclickerLoop() {
             // Otomatik tÄ±klayÄ±cÄ± varsa baÅŸlat
             if (rbpAutoclickerLevel > 0) {
                 window.autoclickerInterval = setInterval(() => {
                     for (let i = 0; i < rbpAutoclickerLevel; i++) {
                         handleManualClick(null); // Otomatik tÄ±klamalar iÃ§in gÃ¶rsel pop-up'Ä± devre dÄ±ÅŸÄ± bÄ±rak
                     }
                 }, 1000); 
             }
        }

        function initializeGame() {
            initializeFirebase(); // Firebase'i baÅŸlatmayÄ± dener ve Lokal ID'yi ayarlar
            loadGame();

            if (clickButton) clickButton.addEventListener('click', handleManualClick);
            if (rebirthButton) rebirthButton.addEventListener('click', performRebirth);
            if (resetGameButton) resetGameButton.addEventListener('click', resetGame);
            
            if (navClicker) navClicker.addEventListener('click', () => switchView('clickerView'));
            if (navMarket) navMarket.addEventListener('click', () => switchView('marketView'));
            if (navMissions) navMissions.addEventListener('click', () => switchView('missionsView')); 
            if (navRebirthStore) navRebirthStore.addEventListener('click', () => switchView('rebirthStoreView'));
            if (navCompetition) navCompetition.addEventListener('click', () => switchView('competitionView'));
            if (navSettings) navSettings.addEventListener('click', () => switchView('settingsView'));

            startPassiveIncomeLoop();
            startAutoclickerLoop();
            checkMissionProgress(); 
            
            // ğŸ”¥ Her 5 saniyede bir otomatik kaydetme
            setInterval(saveGame, 5000);

            updateDisplay();
            switchView('clickerView'); 
        }

        document.addEventListener('DOMContentLoaded', initializeGame);
        
    </script>
</body>
</html>
