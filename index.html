<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tek Dosyada Mini Oyun Merkezi</title>

    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            background-color: #1a1a2e; /* Koyu arka plan */
            color: #ffffff;
            padding-top: 20px;
        }

        #game-container {
            width: 640px;
            height: 480px;
            margin: 20px auto;
            border: 4px solid #00aaff; /* CanlÄ± mavi Ã§erÃ§eve */
            background-color: #2c2c54;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* Canvas'Ä± iÃ§eride tutmak iÃ§in */
        }

        #randomGameBtn {
            padding: 12px 25px;
            font-size: 18px;
            background-color: #00aaff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #randomGameBtn:hover {
            background-color: #0077cc;
        }
        
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <header>
        <h1>ðŸ‘¾ Rastgele Oyun JeneratÃ¶rÃ¼</h1>
        <p>Hemen oyna!</p>
    </header>

    <div id="controls">
        <button id="randomGameBtn">Rastgele Oyun YÃ¼kle ve Oyna</button>
        <p id="gameTitle" style="margin-top: 10px; font-weight: bold;">(Oyun YÃ¼klenmeyi Bekliyor...)</p>
    </div>
    
    <div id="game-container">
        </div>

    <script>
        // ------------------------------------------------------------------
        // A) OYUN VERÄ°SÄ° (VeritabanÄ± Yerine)
        // ------------------------------------------------------------------
        const GAME_DATA = [
            {
                id: 1,
                name: "KÄ±rmÄ±zÄ± Kare KaÃ§Ä±ÅŸ",
                author: "GeliÅŸtirici Alpha",
                // Bu fonksiyon, oyunu Ã§alÄ±ÅŸtÄ±ran kodun kendisidir.
                run: function(canvas, ctx) {
                    let x = 50;
                    let y = 50;
                    const speed = 5;

                    function update() {
                        // Klavye giriÅŸini kontrol et
                        if (keys['ArrowRight']) x += speed;
                        if (keys['ArrowLeft']) x -= speed;
                        if (keys['ArrowDown']) y += speed;
                        if (keys['ArrowUp']) y -= speed;

                        // SÄ±nÄ±rlarÄ± kontrol et
                        if (x < 0) x = 0;
                        if (x > canvas.width - 20) x = canvas.width - 20;
                        if (y < 0) y = 0;
                        if (y > canvas.height - 20) y = canvas.height - 20;
                    }

                    function draw() {
                        // Arka planÄ± temizle
                        ctx.fillStyle = '#2c2c54';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        
                        // Kareyi Ã§iz
                        ctx.fillStyle = 'red';
                        ctx.fillRect(x, y, 20, 20);
                    }
                    
                    // Motorun bu oyun iÃ§in dÃ¶ngÃ¼yÃ¼ baÅŸlatmasÄ±nÄ± saÄŸla
                    window.GameEngine.startLoop(update, draw);
                }
            },
            {
                id: 2,
                name: "Mavi ZÄ±playan Top",
                author: "GeliÅŸtirici Beta",
                run: function(canvas, ctx) {
                    let x = canvas.width / 2;
                    let y = canvas.height / 2;
                    let dx = 3;
                    let dy = 3;
                    const radius = 15;

                    function update() {
                        x += dx;
                        y += dy;

                        // Duvarlarla Ã§arpÄ±ÅŸma
                        if (x + radius > canvas.width || x - radius < 0) {
                            dx = -dx;
                        }
                        if (y + radius > canvas.height || y - radius < 0) {
                            dy = -dy;
                        }
                    }

                    function draw() {
                        ctx.fillStyle = '#2c2c54';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);

                        ctx.beginPath();
                        ctx.arc(x, y, radius, 0, Math.PI * 2);
                        ctx.fillStyle = 'blue';
                        ctx.fill();
                        ctx.closePath();
                    }

                    window.GameEngine.startLoop(update, draw);
                }
            }
            // Ä°stediÄŸiniz kadar yeni oyun ekleyebilirsiniz
        ];

        // ------------------------------------------------------------------
        // B) OYUN MOTORU Ã‡EKÄ°RDEÄžÄ° (ENGINE CORE)
        // ------------------------------------------------------------------
        // Bu nesne, tÃ¼m oyunlar iÃ§in temel motor iÅŸlevlerini saÄŸlar.
        window.GameEngine = {
            isRunning: false,
            frameRequest: null,
            currentUpdate: null,
            currentDraw: null,
            keys: {}, // Klavye durumunu tutan obje
            
            // TÃ¼m oyunlar bu fonksiyonla baÅŸlar
            startLoop: function(updateFunc, drawFunc) {
                // EÄŸer zaten Ã§alÄ±ÅŸÄ±yorsa, Ã¶nceki dÃ¶ngÃ¼yÃ¼ durdur
                if (this.isRunning) {
                    this.stopLoop();
                }
                
                this.currentUpdate = updateFunc;
                this.currentDraw = drawFunc;
                this.isRunning = true;
                this.loop();
            },

            // Oyun dÃ¶ngÃ¼sÃ¼ (60 FPS iÃ§in optimize edilmiÅŸtir)
            loop: function() {
                if (!window.GameEngine.isRunning) return;

                // 1. GÃ¼ncelleme
                window.GameEngine.currentUpdate();
                
                // 2. Ã‡izim
                window.GameEngine.currentDraw();
                
                // Bir sonraki frame iÃ§in tekrar Ã§aÄŸÄ±r
                window.GameEngine.frameRequest = requestAnimationFrame(window.GameEngine.loop);
            },

            // Klavye giriÅŸi iÃ§in olay dinleyicilerini kurar
            setupInput: function() {
                document.addEventListener('keydown', (e) => {
                    this.keys[e.key] = true;
                });
                document.addEventListener('keyup', (e) => {
                    this.keys[e.key] = false;
                });
            },

            // Motoru tamamen durdurur
            stopLoop: function() {
                if (this.frameRequest) {
                    cancelAnimationFrame(this.frameRequest);
                }
                this.isRunning = false;
                this.currentUpdate = null;
                this.currentDraw = null;
            }
        };

        // Klavye objesini global olarak tanÄ±mla ki oyunlar eriÅŸebilsin
        const keys = window.GameEngine.keys;

        // ------------------------------------------------------------------
        // C) PLATFORM MANTIK (APP.JS Yerine)
        // ------------------------------------------------------------------
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('game-container');
            const button = document.getElementById('randomGameBtn');
            const titleDisplay = document.getElementById('gameTitle');
            
            // Klavye dinleyicilerini baÅŸlat
            window.GameEngine.setupInput();

            function loadRandomGame() {
                // EÄŸer bir oyun Ã§alÄ±ÅŸÄ±yorsa durdur
                window.GameEngine.stopLoop();
                
                // Konteyneri temizle (Canvas'Ä± kaldÄ±rmak iÃ§in)
                container.innerHTML = '';
                
                // Canvas elementini oluÅŸtur
                const canvas = document.createElement('canvas');
                canvas.width = 640;
                canvas.height = 480;
                container.appendChild(canvas);
                const ctx = canvas.getContext('2d');

                // Rastgele bir oyun seÃ§
                const randomIndex = Math.floor(Math.random() * GAME_DATA.length);
                const selectedGame = GAME_DATA[randomIndex];

                // BaÅŸlÄ±k bilgisini gÃ¼ncelle
                titleDisplay.textContent = `${selectedGame.name} (Yazar: ${selectedGame.author})`;

                // Oyunu Ã§alÄ±ÅŸtÄ±r
                try {
                    selectedGame.run(canvas, ctx);
                } catch (e) {
                    console.error("Oyun yÃ¼klenirken bir hata oluÅŸtu:", e);
                    titleDisplay.textContent = "HATA: Oyun yÃ¼klenemedi.";
                    container.innerHTML = `<p style="color: red;">Oyun YÃ¼kleme HatasÄ±!</p>`;
                }
            }

            // Butona tÄ±klama olayÄ±nÄ± ata
            button.addEventListener('click', loadRandomGame);
            
            // Sayfa yÃ¼klendiÄŸinde hemen bir oyun baÅŸlat
            loadRandomGame();
        });

    </script>
</body>
</html>
